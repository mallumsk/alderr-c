  const isMobile = () => window.innerWidth < 640;











































































































































































































































































      });        });          }            );              "mt-4"              "border-b-0",              "border-x-0",              "relative",            toggleDiv.classList.remove(            );              "border"              "sm:border-x-0",              "sm:rounded-none",              "z-50",              "top-0",              "absolute",            toggleDiv.classList.add(            // Apply desktop overlay classes on resize if it needs to be moved back            );              mainContentContainer              toggleDiv,            desktopInsertionAnchor.insertBefore(            closeDiv(true);          if (!isMobile() && toggleDiv.parentNode !== desktopInsertionAnchor) {          // Ensure the panel is correctly positioned on resize if changing from mobile to desktop view
n        window.addEventListener("resize", () => {        });          });            openTab(button.getAttribute("data-tab"));          button.addEventListener("click", () => {
n        tabButtons.forEach((button) => {        });          }            }              closeDiv(false);            ) {              !header.contains(event.target)              !toggleDiv.contains(event.target) &&            if (            // Check if click target is outside the panel AND outside the header          if (isPanelOpen) {
n        document.addEventListener("click", (event) => {        });          closeDiv(true);
n        closeButton.addEventListener("click", () => {        });          });            openDiv(button);            }              return;              closeDiv(true);
n            if (isPanelOpen && activeNavButton === button) {            event.stopPropagation();          button.addEventListener("click", (event) => {
n        navButtons.forEach((button) => {        });          }            closeDiv(true);          if (isPanelOpen) {          mobileMenu.classList.toggle("hidden");        mobileMenuButton.addEventListener("click", () => {
n        // --- Event Listeners (mostly unchanged) ---        };          }            titleSpan.classList.add('spruce');            titleSpan.classList.remove(...ALL_TEXT_CLASSES, 'text-gray-700');          if (titleSpan) {          const titleSpan = document.getElementById("nav-link-title");
n          // Update the title color inside the tab pane          contentDiv.classList.add('text-gray-700');          contentDiv.classList.remove(...ALL_TEXT_CLASSES);          // remove any colored text classes and use neutral gray for content          const contentDiv = document.getElementById("tabContent");
n          // Update text color for content inside the tab pane          document.getElementById(tabId).classList.remove("hidden");
n          // 6. Show active tab pane and set dynamic text colors          tabContentWrapper.classList.add('bg-white');
n          // 5. Do not apply any colored background to the content wrapper (keep white)          }            activeBtn.classList.add("spruce", "tab-active");            // Keep active text color as 'spruce' only            activeBtn.classList.remove(...ALL_TEXT_CLASSES, 'text-gray-700');            // Remove any previously applied text classes and neutral gray          if (activeBtn) {          );            `.tab-btn[data-tab="${tabId}"]`          const activeBtn = document.querySelector(
n          // 4. Apply ACTIVE Button Colors          tabContentWrapper.classList.add('bg-white');          tabContentWrapper.classList.remove(...ALL_BG_CLASSES);
n          // 3. Clean up content wrapper colors and ensure it stays white          });            pane.classList.add("hidden");          tabPanes.forEach((pane) => {
n          // 2. Hide all tab content panes          });            btn.classList.add('text-gray-700');
n            // Set inactive button label color to neutral gray            );              'text-gray-700'              ...ALL_TEXT_CLASSES,              ...ALL_BG_CLASSES,              ...ALL_BUTTON_BG_CLASSES,              "tab-active",            btn.classList.remove(            // Ensure any previously applied colored classes are removed          tabButtons.forEach((btn) => {
n          // 1. Clean up ALL tab buttons and set INACTIVE colored state          const colorSet = COLORS[tabId];        const openTab = (tabId) => {
n        // --- Tab Switching Function (unchanged) ---        };          }            mobileMenu.classList.add("hidden");          ) {            !mobileMenu.classList.contains("hidden")            !isManualClose &&            isMobile() &&          if (
n          // Only close the mobile menu if the close trigger was NOT the internal close button or manual toggle.          isPanelOpen = false;          toggleDiv.classList.remove("smooth-show");          toggleDiv.classList.add("smooth-hide");
n          // Hide Panel          }            activeNavButton = null;            if (arrow) arrow.classList.remove("rotated");            const arrow = getArrow(activeNavButton);            activeNavButton.classList.remove("nav-active");          if (activeNavButton) {          // Remove active state and rotation
n        const closeDiv = (isManualClose = false) => {        };          isPanelOpen = true;          toggleDiv.classList.remove("smooth-hide");          toggleDiv.classList.add("smooth-show");
n          // 5. Show Panel          activeNavButton = button;          if (currentArrow) currentArrow.classList.add("rotated");          const currentArrow = getArrow(button);          button.classList.add("nav-active");          navLinkTitle.textContent = linkName;
n          // 4. Navigation Active State & Arrow Update          }            openTab("tab1"); // Default to Tab 1 if content is tabbed                       tabbedContent.classList.remove("hidden");            aboutContent.classList.add("hidden");          } else {                         aboutContent.classList.remove("hidden");            tabbedContent.classList.add("hidden");          if (isAboutPanel) {
n          // 3. Conditional Content Toggle          }            );              "mt-4"              "border-b-0",              "border-x-0",              "relative",            toggleDiv.classList.remove(            );              "border"              "sm:border-x-0",              "sm:rounded-none",              "z-50",              "top-14",              "absolute",            toggleDiv.classList.add(            // Apply ABOLUTE positioning to overlay content. top-0 aligns it exactly below the fixed header.            }              );                mainContentContainer                toggleDiv,              desktopInsertionAnchor.insertBefore(            if (toggleDiv.parentNode !== desktopInsertionAnchor) {            // Desktop: Panel uses absolute positioning to overlay content          } else {            );              "border"              "sm:border-x-0",              "sm:rounded-none",              "mt-4",              "z-50",              "top-0",              "absolute",            toggleDiv.classList.remove(            toggleDiv.classList.add("relative", "border-x-0", "border-b-0");            // Ensure relative positioning and mobile styles            button.parentNode.insertBefore(toggleDiv, button.nextSibling);            // Mobile: Panel remains in normal flow (relative) to push content down          if (isMobile()) {
n          // 2. Dynamic Panel Movement (Mobile/Desktop) & Class Setup          }            if (prevArrow) prevArrow.classList.remove("rotated");            const prevArrow = getArrow(activeNavButton);            activeNavButton.classList.remove("nav-active");          if (activeNavButton) {
n          // 1. Navigation Active State & Arrow Cleanup          const isAboutPanel = linkName === "About";          const linkName = button.getAttribute("data-link");        const openDiv = (button) => {
n        // --- Panel Visibility Functions ---        };          return button.querySelector(".arrow");        const getArrow = (button) => {
n        // --- Arrow Helper ---        const ALL_INACTIVE_CLASSES = ["text-gray-700", "hover:bg-gray-100"];        ];          'text-green-800',          "text-amber-800",          "text-pink-800",          "text-indigo-800",        const ALL_TEXT_CLASSES = [        // Keep an array of colored text classes so we can remove them if present        ];          "bg-green-200",          "bg-amber-200",          "bg-pink-200",          "bg-indigo-200",        const ALL_BUTTON_BG_CLASSES = [
n        const ALL_BG_CLASSES = ['bg-indigo-50', 'bg-pink-50', 'bg-amber-50', 'bg-green-50'];        };          tab4: "",          tab3: "",          tab2: "",          tab1: "",        const INACTIVE_HOVER_CLASSES = {
n        // Remove hover background classes to avoid any colored hover backgrounds        };          tab4: { contentBg: '', buttonBg: '', contentText: '', titleText: '' },          tab3: { contentBg: '', buttonBg: '', contentText: '', titleText: '' },          tab2: { contentBg: '', buttonBg: '', contentText: '', titleText: '' },          tab1: { contentBg: '', buttonBg: '', contentText: '', titleText: '' },        const COLORS = {        // use 'spruce' for active elements and neutral gray for content.        // Remove colored text utilities; keep backgrounds empty. We'll        // tabs and the tab content wrapper remain white.        // Keep color *text* settings but remove any background utilities so
n        // Define all colors associated with each tab (unchanged)        let activeNavButton = null;
n        let isPanelOpen = false;        const tabContentWrapper = document.getElementById("tabContentWrapper");        const tabPanes = document.querySelectorAll(".tab-pane");
n        const tabButtons = document.querySelectorAll(".tab-btn");        const tabbedContent = document.getElementById("tabbed-content");        const howitworkContent = document.getElementById("how-it-work-content");
n        const aboutContent = document.getElementById("about-content");        );          "main-content-container"        const mainContentContainer = document.getElementById(        // The constraint element used to determine where to place the panel relative to page content        );          "desktop-page-wrapper"        const desktopInsertionAnchor = document.getElementById(
n        // New Anchor Point for Desktop Insertion (the full width container)        const mobileMenu = document.getElementById("mobile-menu");        const mobileMenuButton = document.getElementById("mobile-menu-button");        const navLinkTitle = document.getElementById("nav-link-title");        const header = document.getElementById("header");        const toggleDiv = document.getElementById("toggleDiv");        const closeButton = document.getElementById("closeButton");        const navButtons = document.querySelectorAll(".nav-toggle-btn");
n      document.addEventListener("DOMContentLoaded", () => {      document.getElementById("toggleDiv").classList.add("smooth-hide");n      // Flicker Fix: Ensure the panel is hidden immediately on load